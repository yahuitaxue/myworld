---
title: MySQL内核-InnoDB存储引擎
author: Yahui
layout: mysql
category: MySQL
---


书名:《MySQL内核-InnoDB存储引擎》

<pre style="text-align: left;">
	1.重做日志(存储引擎层产生的,物理逻辑格式日志;记录的是每个页的修改;事务进行中不断地写入)
		用来实现事务的持久性,即事务ACID中的D,重做日志分为两部分:
			1.内存中的重做日志缓存,是易失的
			2.重做日志文件,是持久的
		当事务commit(提交)时,必须将该事务的所有日志写入到重做日志文件进行持久化,待完成后事务commit操作才算完成
		日志主要分为两部分:
			1.redo log(保证事务的持久性)
				基本上是顺序写的,在数据库运行时不需要对该日志文件进行读取操作
			2.undo log(帮助事务回滚及MVCC功能)
				是需要进行随机读/写的
		innodb_flush_log_at_trx_commit来控制重做日志刷新到磁盘的策略
			0:表示事务提交时并不强制一定要写入到重做日志,这个仅在master thread中完成,而master thread中每秒会进行一次重做日志文件的fsync操作,因此当MySQL发生宕机的时候,可能会发生最后一秒内事务丢失的情况.
			1(默认):事务必须将所有日志写入到磁盘
			2:事务提交时将重做日志写入到日志文件,但仅写入到文件系统的缓存中,不进行fsync操作.因此当MySQL宕机的时候,并不会导致事务数据的丢失,但是操作系统也宕机的时候,就会丢失那部分的数据.
	2.二进制日志(数据库的上层生成的,是一种逻辑日志;记录的是根据对应的SQL语句;事务提交完成后进行一次写入)
		用来进行point-in-time(恢复到某个时间点)及主从复制环境的建立
</pre>